# Data Inputs, Outputs, and Validation

This document summarizes the primary data inputs, outputs, model assumptions,
and validation checks used across the pricing and risk workflows.

## Inputs
- Market snapshot (`MarketDataSnapshot`):
  - `spot` equity price, curves (discount/funding/borrow), dividends, vol surface.
  - Time uses a 365-day year fraction; forward uses funding - dividend - borrow.
- Curves:
  - Flat curves (`FlatCurve`) or term structures (`ZeroCurve`).
- Vol surfaces:
  - Flat vol (`FlatVolSurface`) or simple smile (`SmileVolSurface`).
- Portfolio:
  - Positions specify product, model, engine, quantity, and pricing settings.
- Scenario history:
  - Generated by `market_risk/mock_data.py` or provided as snapshots for historical shocks.

## Outputs
- Pricing reports (sample trades):
  - `pricing_engine/reports/pricing_report_YYYYMMDD.json`
  - `pricing_engine/reports/pricing_report_YYYYMMDD.csv`
  - `pricing_engine/reports/pricing_report_YYYYMMDD.html`
- Risk reports (mock IMA):
  - `market_risk/reports/ima_report_YYYYMMDD.json`
  - `market_risk/reports/ima_report_YYYYMMDD.csv`
  - `market_risk/reports/ima_report_YYYYMMDD.html`
- Grid approximation diagnostics:
  - `market_risk/reports/grid_approx_report_YYYYMMDD.json`
  - `market_risk/reports/grid_approx_report_YYYYMMDD.csv`
  - `market_risk/reports/grid_approx_report_YYYYMMDD.html`
- Grid checks (sensitivity maps):
  - `market_risk/reports/grid_check_YYYYMMDD.json`
  - `market_risk/reports/grid_check_YYYYMMDD.html`
- Run logs (metadata + checksums):
  - `market_risk/reports/runs/YYYYMMDD/run_<uuid>.json`

## Model assumptions
- Pricing engines support limited product/model combinations (see `docs/spec.md`).
- Monte Carlo engines are simplified and focus on pedagogical clarity.
- Local and local-stochastic volatility calibration is a lightweight placeholder.
- Multi-asset correlation is not implemented (basket proxy only).

## Validation checks
- Pricing:
  - Analytic vs numeric pricing for BS products.
  - Bump-based Greek sanity (delta/gamma/vega).
- Market risk:
  - Historical VaR/ES with backtesting traffic light classification.
  - PLA metrics: correlation, beta, RMSE, explained ratio.
  - Grid sensitivity checks with interpolation error maps.
